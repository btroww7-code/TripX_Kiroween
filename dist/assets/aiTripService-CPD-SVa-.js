import{s as p}from"./index-s9rZPGJJ.js";async function y(t){var s,l,d,c,g;try{console.log("ðŸš€ Calling Supabase Edge Function: generate-trip-ai",t);const{data:e,error:o}=await p.functions.invoke("generate-trip-ai",{body:{destination:t.destination,days:t.days,budget:t.budget,interests:t.interests}});if(o){console.error("âŒ Edge Function error:",o),console.error("âŒ Error details:",JSON.stringify(o,null,2));let r=o.message||"Failed to generate trip plan";throw o.context&&(console.error("âŒ Error context:",o.context),o.context.message&&(r=o.context.message)),r.includes("API keys")||r.includes("GOOGLE_AI_KEY")||r.includes("MAPS_API_KEY")?new Error("API configuration error. The Edge Function needs API keys to be configured. Please contact support."):r.includes("Could not find destination")?new Error(`Could not find "${t.destination}". Try a more specific location like "Paris, France" or "Tokyo, Japan".`):r.includes("500")||r.includes("non-2xx")||r.includes("FunctionsHttpError")?e&&typeof e=="object"&&"error"in e?new Error(`${e.error}${e.details?": "+e.details:""}`):new Error("Trip generation service is currently unavailable. Please try again in a moment."):new Error(r)}if(!e)throw new Error("Edge Function returned no data. Please check Edge Function logs in Supabase Dashboard.");if(console.log("ðŸ“¦ Edge Function response data:",e),e.error){console.error("âŒ Edge Function returned error in data:",e.error);const r=e.details?`

Details: ${e.details}`:"";throw new Error(`${e.error}${r}`)}const i={trip_overview:e.trip_overview||{},destination_info:e.destination_info||{},daily_plan:e.daily_plan||[],hotels:e.hotels||[],generated_quests:e.generated_quests||[],metadata:e.metadata||{},days:e.daily_plan||[],attractions:(e.daily_plan||[]).flatMap(r=>(r.attractions||[]).map(n=>{var a;return{name:n.name,location:n.name,coordinates:n.coordinates,price:n.estimated_cost||0,rating:n.rating||0,description:n.description,photo_url:(a=n.photos)==null?void 0:a[0],opening_hours:n.opening_hours,type:n.category||"attraction"}}))};return console.log("âœ… Trip plan generated successfully:",{destination:(s=i.trip_overview)==null?void 0:s.city,days:(l=i.daily_plan)==null?void 0:l.length,hotels:(d=i.hotels)==null?void 0:d.length,quests:(c=i.generated_quests)==null?void 0:c.length,activities:(g=i.daily_plan)==null?void 0:g.reduce((r,n)=>{var a;return r+(((a=n.attractions)==null?void 0:a.length)||0)},0)}),i}catch(e){throw console.error("ðŸ’¥ Trip Generation Error:",e),new Error(e.message||"Failed to generate trip. Please check your internet connection and try again.")}}export{y as generateTripPlan};
